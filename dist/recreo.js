var r=class n{constructor(t,i){this.x=t,this.y=i}static get Zero(){return new n(0,0)}Magnitude(){return Math.sqrt(this.sqrMagnitude)}SqrMagnitude(){return this.x*this.x+this.y*this.y}Normalized(){return this.Copy().Divide(this.magnitude)}Copy(){return new n(this.x,this.y)}Sum(t){return t instanceof n?new n(this.x+t.x,this.y+t.y):this.Copy()}Substract(t){return t instanceof n?new n(this.x-t.x,this.y-t.y):this.Copy()}Multiply(t){return new n(this.x*t,this.y*t)}Divide(t){return new n(this.x/t,this.y/t)}DotProduct(t){return new n(this.x*t.x,this.y*t.y)}DotDivision(t){return new n(this.x/t.x,this.y/t.y)}InvertY(){return new n(this.x,-this.y)}InvertX(){return new n(-this.x,this.y)}Rotate(t,i){let s=this.x-i.x,e=this.y-i.y,h=Math.cos(t/2/Math.PI),o=Math.sin(t/2/Math.PI),a=s*h-e*o,u=s*o-e*h;return a+=i.x,u+=i.y,new n(a,u)}};var d=class{constructor(t,i,s,e,h,o=void 0,a=void 0){this._NAME=void 0,this._GAME=t,this.position=new r(i,s),this.size=new r(e,h),this._IMAGE=new Image,this._IMAGE.src=o!==void 0?o:"",this.url=o!==void 0,this.canDraw=o===void 0,this._IMAGE.onload=()=>{this.canDraw=!0},this.color=a,this.static=!1}draw=t=>{this.canDraw&&(this.url?t.drawImage(this._IMAGE,this.position.x+(this.static?-this._GAME.currentRoom.positionContextRoom.x:0),this.position.y+(this.static?-this._GAME.currentRoom.positionContextRoom.y:0),this.size.x,this.size.y):this.color&&(t.fillStyle=this.color,t.fillRect(this.position.x+(this.static?-this._GAME.currentRoom.positionContextRoom.x:0),this.position.y+(this.static?-this._GAME.currentRoom.positionContextRoom.y:0),this.size.x,this.size.y)))};steps=()=>{};main=t=>{this.steps(),this.draw(t)}};var l=class{#t=!1;constructor(t,i,s,e,h){this._GAME=t,this._NAME=void 0,this._PARENT=void 0,this._CHILDREN={},this.position=new r(i,s),this.size=new r(e,h)}onCreate=()=>{};kamikaze=(t=()=>{})=>{t&&t(),this?._PARENT?._CHILDREN?this._PARENT._CHILDREN=delete this._PARENT._CHILDREN[this._NAME]:this._GAME.currentRoom.removeInstance(!1,this._NAME)};changePosition=(t,i)=>{this.position=this._PARENT?new r(this._PARENT.position.x+t,this._PARENT.position.y+i):new r(t,i)};updatePosition=()=>{this.position=this._PARENT?new r(this._PARENT.position.x+this.position.x,this._PARENT.position.y+this.position.y):this.position};restartPosition=()=>{this.position=this._PARENT?new r(this.position.x-this._PARENT.position.x,this.position.y-this._PARENT.position.y):this.position};addChild=(t,i)=>{if(!this._CHILDREN[i])this._CHILDREN[i]=t,t._PARENT=this,t._NAME=i;else if(this._CHILDREN[i])throw new Error(`${i} does exist in UI`)};getChild=t=>this._CHILDREN[t];delteChild=t=>delete this._CHILDREN[t];draw=t=>{};steps=()=>{};main=(t,i)=>{this.#t||(this.onCreate(),this.#t=!0),this.updatePosition(),this.steps(i),this.draw(t)}};var m=class n extends l{constructor(t,i,s,e,h,o,a=[],u=!1){super(t,i,s,e,h),this.layer=o,this.exceptions=a,this.show=u,this.absolutePosition=new r(-9999999,-9999999),this.collides=new Set}updatePosition=()=>{this.position=this._PARENT?new r(this._PARENT.position.x+this.position.x,this._PARENT.position.y+this.position.y):this.position,this.absolutePosition.x=this.position.x,this.absolutePosition.y=this.position.y};draw=t=>{this.show&&(t.strokeStyle="#f00",t.strokeRect(this.position.x,this.position.y,this.size.x,this.size.y))};iterateTree=(t,i=void 0,s=new Set)=>{if(i){if(t(i))return{res:!0,target:i};if(s.add(i),i._CHILDREN.length===0)return this.iterateTree(t,i._PARENT,s);if(i._CHILDREN.length!==0){let h=window.Object.values(i._CHILDREN).filter(o=>!s.has(o));return h.length===0?this.iterateTree(t,i._PARENT,s):this.iterateTree(t,h[0],s)}}let e=window.Object.values(this._GAME.currentRoom._INSTANCES).filter(h=>!s.has(h));return e.length===0?{res:!1,target:void 0}:this.iterateTree(t,e[0],s)};collideRules=t=>!(t===this||!(t instanceof n)||t.layer!==this.layer&&t.exceptions.includes(t));onArea=(t=l)=>this.iterateTree(i=>!this.collideRules(i)||!(i._PARENT instanceof t)?!1:this.absolutePosition.x+this.size.x>=i.absolutePosition.x&&this.absolutePosition.x<=i.absolutePosition.x+i.size.x&&this.absolutePosition.y+this.size.y>=i.absolutePosition.y&&this.absolutePosition.y<=i.absolutePosition.y+i.size.y);onPlaceMeeting=(t,i=l)=>this.iterateTree(s=>!this.collideRules(s)||!(s._PARENT instanceof i)?!1:t.x>=s.absolutePosition.x&&t.x<=s.absolutePosition.x+s.size.x&&t.y>=s.absolutePosition.y&&t.y<=s.absolutePosition.y+s.size.y);onPlaceMeetingBox=(t,i=l)=>this.iterateTree(s=>!this.collideRules(s)||!(s._PARENT instanceof i)?!1:t.x+this.size.x>=s.absolutePosition.x&&t.x<=s.absolutePosition.x+s.size.x&&t.y+this.size.y>=s.absolutePosition.y&&t.y<=s.absolutePosition.y+s.size.y);onRectangleCollision=(t,i,s,e,h=l)=>this.iterateTree(o=>!this.collideRules(o)||!(o._PARENT instanceof h)?!1:t+s>=o.absolutePosition.x&&t<=o.absolutePosition.x+o.size.x&&i+e>=o.absolutePosition.y&&i<=o.absolutePosition.y+o.size.y)};var y=class extends l{#t=new r(0,0);#i=0;#s=0;#e=0;#o=0;constructor(t,i,s,e,h){super(t,i,s,e,h),this.absolutePosition=new r(i,s),this.MODES={Center:"Center",Borders:"Borders"},this.mode=this.MODES.Center,this.paddingX=100,this.paddingY=100,this.scaleX=1,this.scaleY=1,this._ROOM=void 0,this.LIMITS={l:void 0,t:void 0,r:void 0,b:void 0}}setScale=(t,i)=>{this.scaleX=t,this.scaleY=i};setCamaraLimits=(t,i,s,e)=>{this.LIMITS.l=t,this.LIMITS.t=i,this.LIMITS.r=s,this.LIMITS.b=e};steps=()=>{if(!this._ROOM)this._ROOM=this._GAME.currentRoom;else{if(this._ROOM.scaleContextRoom.x=this.scaleX,this._ROOM.scaleContextRoom.y=this.scaleY,this._ROOM.sizeContextRoom=this.size,this._ROOM.positionContextRoom.x=-this.position.x,this._ROOM.positionContextRoom.y=-this.position.y,!this.LIMITS.l&&!this.LIMITS.r&&!this.LIMITS.t&&!this.LIMITS.b)return;let t={x:this.scaleX>1?(this.size.x-this.size.x/this.scaleX)/2:0,y:this.scaleY>1?(this.size.y-this.size.y/this.scaleY)/2:0};this.absolutePosition.x+t.x<this.LIMITS.l?this._ROOM.positionContextRoom.x=this.LIMITS.l+t.x:this.absolutePosition.x+this.size.x-t.x>this.LIMITS.r&&(this._ROOM.positionContextRoom.x=-(this.LIMITS.r-this.size.x+t.x)),this.absolutePosition.y+t.y<this.LIMITS.t?this._ROOM.positionContextRoom.y=this.LIMITS.t+t.y:this.absolutePosition.y+this.size.y-t.y>this.LIMITS.b&&(this._ROOM.positionContextRoom.y=-(this.LIMITS.b-this.size.y+t.y))}};updatePosition=()=>{if(this.mode===this.MODES.Center)this.position=this._PARENT?new r(this._PARENT.position.x+this.position.x-this.size.x/2+this._PARENT.size.x/2,this._PARENT.position.y+this.position.y-this.size.y/2+this._PARENT.size.y/2):this.position;else if(this.mode===this.MODES.Borders){this.#i=Math.round(this.size.x/this.scaleX),this.#s=Math.round(this.size.y/this.scaleY),this.#e=Math.round(this.paddingX/this.scaleX),this.#o=Math.round(this.paddingY/this.scaleY),this.#t=new r(-((this.#i-this.size.x)/2)+this.position.x,-((this.#s-this.size.y)/2)+this.position.y);let t=this.#t.x+this.#e,i=t+this.#i-this.#e*2-this._PARENT.size.x,s=this.#t.y+this.#o,e=s+this.#s-this.#o*2-this._PARENT.size.y;this._PARENT.position.x<t&&(this.position.x-=t-this._PARENT.position.x),this._PARENT.position.x>i&&(this.position.x+=this._PARENT.position.x-i),this._PARENT.position.y<s&&(this.position.y-=s-this._PARENT.position.y),this._PARENT.position.y>e&&(this.position.y+=this._PARENT.position.y-e)}this.absolutePosition=this.position.Copy()};restartPosition=()=>{this.mode===this.MODES.Center&&(this.position=this._PARENT?new r(this.position.x-this._PARENT.position.x+this.size.x/2-this._PARENT.size.x/2,this.position.y-this._PARENT.position.y+this.size.y/2-this._PARENT.size.y/2):this.position)}};var p=class{constructor(t,i,s){this._GAME=t,this.time=i,this.repeat=s,this.current=0,this.running=!1,this.finished=!1,this.oldSec=-1}restart=()=>{this.finished=!1,this.current=0,this.oldSec=-1};start=()=>{this.running=!0};pause=()=>{this.running=!1};tick=(t,i)=>{if(!this.running)return;let s=new Date().getMilliseconds();s!==this.oldSec&&(this.current+=i<1?i:0,this.oldSec=s),this.current>=this.time&&(t&&t(),this.repeat?this.restart():(this.pause(),this.finished=!0))}};var c=class{constructor(t,i){i&&(this._GAME=t,this.keydown=new Set,this.keypress=new Set,this.keyup=new Set,this.mousedown=new Set,this.mousepress=new Set,this.mouseup=new Set,this.mouseCord={x:0,y:0},i.addEventListener("keydown",s=>this._OnKeyDown(s)),i.addEventListener("keyup",s=>this._OnKeyUp(s)),i.addEventListener("mousedown",s=>this._OnMouseDown(s)),i.addEventListener("mouseup",s=>this._OnMouseUp(s)),i.addEventListener("mousemove",s=>this._OnMouseMove(s)),i.addEventListener("contextmenu",s=>s.preventDefault()),i.addEventListener("blur",s=>{this.keydown.clear(),this.keypress.clear(),this.keyup.clear(),this.mousedown.clear(),this.mousepress.clear(),this.mouseup.clear()}))}GetKeyDown=t=>{let i=this.keydown.has(t);return this.keydown.delete(t),i};GetKeyPress=t=>this.keypress.has(t);GetKeyUp=t=>{let i=this.keyup.has(t);return this.keyup.delete(t),i};GetMouseDown=t=>{let i=this.mousedown.has(t);return this.mousedown.delete(t),i};GetMousePress=t=>this.mousepress.has(t);GetMouseUp=t=>{let i=this.mouseup.has(t);return this.mouseup.delete(t),i};GetMouseCords=()=>this.mouseCord;_OnKeyDown=t=>{this.keydown.add(t.key),this.keypress.add(t.key),this.keyup.delete(t.key)};_OnKeyUp=t=>{this.keyup.add(t.key),this.keydown.delete(t.key),this.keypress.has(t.key)&&this.keypress.delete(t.key)};_OnMouseDown=t=>{this.mousedown.add(t.button),this.mousepress.add(t.button),this.mouseup.delete(t.button)};_OnMouseUp=t=>{this.mouseup.add(t.button),this.mousedown.delete(t.button),this.mousepress.has(t.button)&&this.mousepress.delete(t.button)};_OnMouseMove=t=>{let i=this._GAME.viewport.x/this._GAME.$.clientWidth,s=this._GAME.viewport.y/this._GAME.$.clientHeight;this.mouseCord={x:t.offsetX*i,y:t.offsetY*s}}};var x=class{#t=0;#i=new Date().valueOf()/1e3;#s=0;#e=!1;constructor(t,i,s=void 0,e=void 0){this.$=t,this.width=s,this.height=e,this.canvas=i,this.responsive=!0,this.ctx=void 0,this.responsive&&(this.viewport=new r(s||window.screen.width,e||window.screen.height)),this.resize(),window.addEventListener("resize",()=>{this.resize()}),document.addEventListener("visibilitychange",()=>{this.#e=!this.#e}),this.soundsStack=[],this.gamePaused=!1,this.stopedGame=!1,this.gameLoop=void 0,this.rooms=[],this.currentRoom=void 0,this.lastRoom=void 0,this.hoverUI=!1,this.debug=!0,this.smoothImage=!0,this.cancelAnimationFrame=window.cancelAnimationFrame.bind(window)||window.mozCancelAnimationFrame.bind(window),this.requestAnimationFrame=window.requestAnimationFrame.bind(window)||window.mozRequestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame.bind(window)||window.msRequestAnimationFrame.bind(window),this.input=new c(this,this.canvas)}resize=()=>{let t=this.viewport.x/this.viewport.y,i=this.viewport.x*t/100,s=this.viewport.y*t/100;this.responsive?this.width||this.height?(this.$.style.width=this.width+"px",this.$.style.height=this.height+"px",this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px"):this.$.getBoundingClientRect().right/i>this.$.getBoundingClientRect().bottom/s?(this.$.style.width="auto",this.$.style.height="100%"):(this.$.style.width="100%",this.$.style.height="auto"):(this.canvas.style.width="100%",this.canvas.style.height="100%",this.viewport=new r(this.canvas.clientWidth,this.canvas.clientHeight),this.currentRoom&&(this.currentRoom.sizeContextRoom=new r(this.viewport.x,this.viewport.y))),this.canvas.width=this.viewport.x,this.canvas.height=this.viewport.y,this.responsive&&(this.$.style.aspectRatio=`${i} / ${s}`),this.ctx=this.canvas.getContext("2d")};getRoomNames=()=>this.rooms.map(t=>t.name);getRoom=()=>this.currentRoom;addRoom=t=>this.rooms.push(t);changeRoom=(t,i=!1)=>{this.hoverUI=!1;let s=this.currentRoom;if(t===this.lastRoom?._NAME)this.currentRoom=this.lastRoom,this.lastRoom=i?s:void 0;else try{this.currentRoom=new(this.rooms.filter(e=>e.name===t))[0](this),this.lastRoom=i?s:void 0}catch(e){console.log("Was an error to change room",e)}this.resetContextGraphic()};scaleContextGraphic=(t,i)=>{this.ctx.scale(t,i)};clipContextGraphic=(t,i)=>{this.ctx.save(),this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.viewport.x,this.viewport.y);let s=this.viewport.x/2-this.currentRoom.sizeContextRoom.x/2,e=this.viewport.y/2-this.currentRoom.sizeContextRoom.y/2;this.ctx.beginPath(),this.ctx.rect(s,e,t,i),this.ctx.closePath(),this.ctx.clip(),this.ctx.clearRect(s,e,t,i)};resetContextGraphic=()=>{this.ctx.restore(),this.ctx.setTransform(1,0,0,1,0,0)};findSound=t=>{let i=t.split("/"),s=`${i[i.length-2]}/${i[i.length-1]}`;return this.soundsStack.find(e=>e.src.includes(s))};playSound=(t,i,s=1,e=!1)=>{let h=this.findSound(t);if(h===void 0){let o=new Audio(t);o.volume=i,o.loop=e,o.playbackRate=s,o.addEventListener("ended",()=>this.deleteSound(o.src)),o.play(),this.soundsStack.push(o)}else h.paused||(h.pause(),h.currentTime=0),h.play()};pauseSound=t=>{let i=this.findSound(t);i&&i.pause()};deleteSound=t=>{let i=this.findSound(t);i&&(this.soundsStack=this.soundsStack.filter(s=>s!==i))};startGame=()=>{this.gameLoop=this.gameLoop===void 0?this.requestAnimationFrame(this.main):this.gameLoop};stopGame=()=>{this.stopedGame=!0,this.gameLoop=void 0};pauseGame=()=>{this.gamePaused=!0,this.soundsStack.forEach(t=>t.pause())};playGame=()=>{this.gamePaused=!1,this.soundsStack.forEach(t=>t.play())};computedTime=t=>{this.#i=t/1e3,this.#s=this.#i-this.#t,this.#t=this.#i};main=t=>{this.#t===0&&this.resize(),this.computedTime(t),this.debug&&console.log(`%cGAME HOVER = ${this.hoverUI}, mouse:"X:${this.input.mouseCord.x}, Y:${this.input.mouseCord.y}", DeltaTime: ${this.#s}`,"color: #ffed9c; padding: 1px 4px;"),this.ctx.imageSmoothingEnabled=this.smoothImage,this.ctx.imageSmoothingQuality="high",this.currentRoom&&!this.#e&&this.currentRoom.main(this.ctx,this.#s),this.stopedGame?this.cancelAnimationFrame(this.gameLoop):this.gameLoop=this.requestAnimationFrame(this.main)}};var w=class{constructor(t,i,s,e,h,o){this.cutX=t,this.cutY=i,this.cutW=s,this.cutH=e,this.tileWidth=h,this.tileHeight=o}};var E=class{constructor(t){this._GAME=t,this._NAME=this.constructor.name,this.positionContextRoom=new r(0,0),this.sizeContextRoom=new r(this._GAME.viewport.x,this._GAME.viewport.y),this.scaleContextRoom=new r(1,1),this._INSTANCESUI={},this._INSTANCES={},this.backgrounds={},this.tileMapLayer1=void 0,this.tileMapLayer2=void 0,this.tileMapLayer3=void 0}addBackground=(t,i)=>{t._NAME=i,this.backgrounds[i]=t};addInstance=(t,i=!1,s)=>{if(i&&!this._INSTANCESUI[s])t._NAME=s,this._INSTANCESUI[s]=t;else if(i&&this._INSTANCESUI[s])throw new Error(`${s} does exist in UI`);if(!i&&!this._INSTANCES[s])t._NAME=s,this._INSTANCES[s]=t;else if(!i&&this._INSTANCES[s])throw new Error(`${s} does exist`)};removeInstance=(t=!1,i)=>{t?delete this._INSTANCESUI[i]:delete this._INSTANCES[i]};draw=t=>{window.Object.values(this.backgrounds).forEach(i=>i.main(t)),this.tileMapLayer1&&this.tileMapLayer1.main(t),this.tileMapLayer2&&this.tileMapLayer2.main(t)};drawOver=t=>{this.tileMapLayer3&&this.tileMapLayer3.main(t)};renderObejct=(t,i,s)=>{this._GAME.gamePaused?(t.updatePosition(),t.draw(i)):t.main(i,s),window.Object.values(t._CHILDREN).forEach(e=>{this.renderObejct(e,i,s)}),t.restartPosition()};renderUI=(t,i,s)=>{t.main(i,s),t.visible&&window.Object.values(t._CHILDREN).forEach(e=>{this.renderUI(e,i,s)}),t.restartPosition()};findByName=(t,i=!1,s=void 0,e=new Set)=>{if(s){if(s?._PARENT){if(s?._PARENT?._CHILDREN[t]===s)return s}else{if(i&&this._INSTANCESUI[t]===s)return s;if(!i&&this._INSTANCES[t]===s)return s}if(e.add(s),s._CHILDREN.length===0)return this.findByName(t,i,s._PARENT,e);if(s._CHILDREN.length!==0){let o=window.Object.values(s._CHILDREN).filter(a=>!e.has(a));return o.length===0?this.findByName(t,i,s._PARENT,e):this.findByName(t,i,o[0],e)}}let h=window.Object.values(i?this._INSTANCESUI:this._INSTANCES).filter(o=>!e.has(o));if(h.length!==0)return this.findByName(t,i,h[0],e)};findByQuery=(t=[],i=!1,s=void 0,e=new Set)=>{if(s){let o=0;if(t.forEach(a=>{try{let u=s;a.key.split(".").forEach(C=>u=u[C]?u[C]:void 0),a?.not?u!==a.value&&o++:u===a.value&&o++}catch{this._GAME.debug&&console.log("Was an error whit the querys")}}),o===t.length)return s;if(e.add(s),s._CHILDREN.length===0)return this.findByQuery(t,i,s._PARENT,e);if(s._CHILDREN.length!==0){let a=window.Object.values(s._CHILDREN).filter(u=>!e.has(u));return a.length===0?this.findByQuery(t,i,s._PARENT,e):this.findByQuery(t,i,a[0],e)}}let h=window.Object.values(i?this._INSTANCESUI:this._INSTANCES).filter(o=>!e.has(o));if(h.length!==0)return this.findByQuery(t,i,h[0],e)};main=(t,i)=>{this._GAME.clipContextGraphic(this.sizeContextRoom.x,this.sizeContextRoom.y),this._GAME.scaleContextGraphic(this.scaleContextRoom.x,this.scaleContextRoom.y);let s=this.positionContextRoom.x+(this._GAME.viewport.x/2-this.sizeContextRoom.x/2*this.scaleContextRoom.x)/this.scaleContextRoom.x,e=this.positionContextRoom.y+(this._GAME.viewport.y/2-this.sizeContextRoom.y/2*this.scaleContextRoom.y)/this.scaleContextRoom.y;t.translate(s,e),this.draw(t),window.Object.values(this._INSTANCES).forEach(h=>{this.renderObejct(h,t,i)}),this.drawOver(t),this._GAME.resetContextGraphic(),window.Object.values(this._INSTANCESUI).forEach(h=>{this.renderUI(h,t,i)})}};var M=class extends l{constructor(t,i,s,e,h,o){super(t,i,s,e,h),this.url=o,this._IMAGE=new Image(e,h),this._IMAGE.src=o,this.canDraw=!1,this._IMAGE.onload=()=>{this.canDraw=!0},this.flipX=!1,this.flipY=!1,this.cutX=void 0,this.cutY=void 0,this.cutW=void 0,this.cutH=void 0,this.tileWidth=void 0,this.tileHeight=void 0,this.animation=[],this.frame=0,this.frames=-1,this.time=0,this.repeat=!0,this.clock=new p(t,this.time,this.repeat)}onEnd=()=>{};draw=t=>{if(!this.canDraw)return;let i=this.flipX?-1:1,s=this.flipY?-1:1;t.save(),t.scale(i,s),this.cutX!==void 0&&this.cutY!==void 0&&this.cutW!==void 0&&this.cutH!==void 0&&this.tileWidth!==void 0&&this.tileHeight!==void 0?t.drawImage(this._IMAGE,this.cutX,this.cutY,this.cutW,this.cutH,(this.position.x+(i===-1?this.tileWidth:0))*i,(this.position.y+(s===-1?this.tileHeight:0))*s,this.tileWidth,this.tileHeight):t.drawImage(this._IMAGE,(this.position.x+(i===-1?this.size.x:0))*i,(this.position.y+(s===-1?this.size.y:0))*s,this.size.x,this.size.y),t.restore()};play=()=>{this.clock&&this.clock.start()};stop=()=>{this.clock&&this.clock.pause()};cutSprite=(t,i,s,e,h,o)=>{this.cutX=t,this.cutY=i,this.cutW=s,this.cutH=e,this.tileWidth=h,this.tileHeight=o};setAnimation=(t,i=.2,s=!0)=>{this.stop(),this.clock.oldSec=-1,this.clock.current=0,this.clock.time=i,this.clock.repeat=s,this.frame=0,this.frames=t.length-1,this.animation=t,this.time=i,this.repeat=s};changeSprite=t=>{this.url=t,this._IMAGE=new Image(this.size.x,this.size.y),this._IMAGE.src=t,this.canDraw=!1,this._IMAGE.onload=()=>{this.canDraw=!0}};changeAnimation=(t,i=.2,s=!0)=>{this.time=i,this.frame=0,this.frames=t.length-1,this.animation=t,this.repeat=s,this.stop(),this.clock=new p(this._GAME,i,!0),this.play()};steps=t=>{this.clock&&(this.clock.tick(()=>{this.repeat?this.frame=this.frame>=this.frames?0:this.frame+1:this.frame=this.frame<this.frames?this.frame+1:this.frame,!this.repeat&&this.frame>=this.frames&&(this.stop(),this.onEnd())},t),this.frames!==-1&&(this.cutX=this.animation[this.frame].cutX,this.cutY=this.animation[this.frame].cutY,this.cutW=this.animation[this.frame].cutW,this.cutH=this.animation[this.frame].cutH,this.tileWidth=this.animation[this.frame].tileWidth,this.tileHeight=this.animation[this.frame].tileHeight))}};var R=class extends l{constructor(t,i=void 0,s,e,h,o){super(t,0,0,s,e),this._IMAGE=new Image,this._IMAGE.src=i,this.canDraw=!1,this._IMAGE.onload=()=>{this.canDraw=!0},this.tiles=[],this.tileWidth=h,this.tileHeight=o,this.tileImage=void 0}addTile=(t,i,s,e,h,o)=>{this.tiles.push({x:t,y:i,row:s,col:e,cutW:h,cutH:o})};draw=t=>{if(this.canDraw)if(this.tileImage===void 0){let i=document.createElement("canvas");i.setAttribute("width",this.size.x),i.setAttribute("height",this.size.y);let s=i.getContext("2d");s.imageSmoothingEnabled=!1,this.tileImage=new Image,this.tiles.forEach(e=>{s.drawImage(this._IMAGE,e.row*e.cutW,e.col*e.cutH,e.cutW,e.cutH,e.x*this.tileWidth,e.y*this.tileHeight,this.tileWidth,this.tileHeight)}),this.tileImage.src=i.toDataURL()}else t.drawImage(this.tileImage,this.position.x,this.position.y)}};var f=class extends l{#t=!1;constructor(t,i,s,e,h){super(t,i,s,e,h),this.visible=!0,this.enabled=!0,this.mouseOn=!1,this.active=!1,this.leave=!1,this.hover=!1,this.pressed=!1,this.container=!0,this.lastMouseCord={x:-10,y:-10}}draw=t=>{};checkMousePosition=()=>{this.constructor.name==="UI"||this.container||(this._GAME.input.GetMouseCords().x>=this.position.x&&this._GAME.input.GetMouseCords().x<=this.position.x+this.size.x&&this._GAME.input.GetMouseCords().y>=this.position.y&&this._GAME.input.GetMouseCords().y<=this.position.y+this.size.y?(this.hover=!0,this._GAME.hoverUI=!0):this.active&&this._GAME.input.GetMouseDown(0)?(this.active=!1,this.onBlur()):this.hover&&(this.pressed=!1,this.leave=!0,this.hover=!1,this._GAME.hoverUI=!1))};onBlur=()=>{};onClick=()=>{};onFocus=()=>{};onMouseDown=()=>{};onMouseUp=()=>{};onMouseMove=()=>{};onMouseHover=()=>{};onMouseLeave=()=>{};onKeyDown=()=>{};onKeyUp=()=>{};events=()=>{!this.visible||!this.enabled||(this.checkMousePosition(),this.hover&&!this.mouseOn&&(this.onMouseHover(),this.mouseOn=!0),this.leave&&(this.onMouseLeave(),this.leave=!1,this.mouseOn=!1),this.mouseOn&&this._GAME.input.GetMouseDown(0)&&(this.onMouseDown(),this.pressed=!0,this.active||this.onFocus(),this.active=!0),this.mouseOn&&this.active&&this.pressed&&this._GAME.input.GetMouseUp(0)&&(this.onMouseUp(),this.onClick(),this.pressed=!1),this.mouseOn&&this.lastMouseCord!==this._GAME.input.GetMouseCords()&&(this.onMouseMove(),this.lastMouseCord=this._GAME.input.GetMouseCords()),this.active&&this._GAME.input.keydown.size!==0&&this.onKeyDown(),this.active&&this._GAME.input.keyup.size!==0&&this.onKeyUp())};steps=t=>{};main=(t,i)=>{this.#t||(this.onCreate(),this.#t=!0),this.visible&&(this.updatePosition(),this.events(),this.steps(i),this.draw(t))}};var _=class extends f{constructor(t,i,s,e,h,o){super(t,i,s,e,h),this.container=!1,this.text=o,this.font="16px sans-serif",this.backgroundColor="#aaa",this.color="#222",this.fill=!0,this.border=!1,this.borderWeight=1,this.borderColor="#000",this.align="center",this.textMetrics=new r(0,0),this.backgroundColorHover="#0ea5e9",this.colorHover="#fff",this.borderColorHover="#000",this.backgroundColorPressed="#0089C6",this.colorPressed="#6BC8F2",this.borderColorPressed="#000"}drawBody=t=>{this.hover&&!this.pressed?t.fillStyle=this.backgroundColorHover:this.hover&&this.pressed?t.fillStyle=this.backgroundColorPressed:t.fillStyle=this.backgroundColor,t.fillRect(this.position.x,this.position.y,this.size.x,this.size.y),this.border&&(this.hover&&!this.pressed?t.strokeStyle=this.borderColorHover:this.hover&&this.pressed?t.strokeStyle=this.borderColorPressed:t.strokeStyle=this.borderColor,t.lineWidth=this.borderWeight,t.strokeRect(this.position.x,this.position.y,this.size.x,this.size.y))};draw=t=>{t.save(),t.beginPath(),t.rect(this.position.x,this.position.y,this.size.x,this.size.y),t.clip(),t.font=this.font,this.textMetrics.x=Math.ceil(t.measureText(this.text).width),this.textMetrics.y=Math.ceil(t.measureText(this.text).hangingBaseline),this.drawBody(t),this.hover&&!this.pressed?(t.fillStyle=this.colorHover,t.strokeStyle=this.colorHover):this.hover&&this.pressed?(t.fillStyle=this.colorPressed,t.strokeStyle=this.colorPressed):(t.fillStyle=this.color,t.strokeStyle=this.color);let i=this.align==="center"?this.size.x/2-this.textMetrics.x/2:this.align==="right"?this.size.x-this.textMetrics.x:0;this.fill?t.fillText(this.text,this.position.x+i,this.position.y+this.textMetrics.y/2+this.size.y/2):t.strokeText(this.text,this.position.x+i,this.position.y+this.textMetrics.y/2+this.size.y/2),t.restore()}};var A=class extends f{constructor(t,i,s,e,h,o="",a="placeholder"){super(t,i,s,e,h),this.container=!1,this.text=o,this.maxTextLength=50,this.placeholder=a,this.font="16px sans-serif",this.placeholderColor="#555",this.backgroundColor="#aaa",this.colorPointer="#000",this.pointer=0,this.color="#222",this.fill=!0,this.border=!1,this.activeBorderColor="#0ea5e9",this.textMetrics=new r(0,0),this.backgroundColorHover="#0ea5e9",this.colorHover="#fff"}onKeyDown=()=>{let t="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM\xF1\xD1,.-_;:[]{}''*+^\xA8\xB0!|#$%&/()=?\xA1\xBF ".split("");c.GetKeyDown("ArrowLeft")&&(this.pointer+=this.pointer>0?-1:0),c.GetKeyDown("ArrowRight")&&(this.pointer+=this.pointer<this.text.length?1:0),c.GetKeyDown("End")&&(this.pointer=this.text.length),c.GetKeyDown("Home")&&(this.pointer=0),c.GetKeyDown("Backspace")&&(this.text=this.text.split("").filter((i,s)=>s===this.pointer-1?"":i).join(""),this.pointer+=this.pointer>0?-1:0),t.forEach(i=>{this.text.length>=this.maxTextLength||c.GetKeyDown(i)&&(this.text===""?(this.text+=i,this.pointer++):this.pointer===0?(this.text=i+this.text,this.pointer++):(this.text=this.text.split("").map((s,e)=>e===this.pointer-1?s+i:s).join(""),this.pointer++))})};onBlur=()=>{this.pointer=0};draw=t=>{t.save(),t.beginPath(),t.rect(this.position.x,this.position.y,this.size.x,this.size.y),t.clip(),t.font=this.font,this.textMetrics.x=Math.ceil(t.measureText(this.text).width),this.textMetrics.y=Math.ceil(t.measureText(this.text).hangingBaseline),t.fillStyle=this.hover?this.backgroundColorHover:this.backgroundColor,t.fillRect(this.position.x,this.position.y,this.size.x,this.size.y);let i=0;t.measureText(this.text.substr(0,this.pointer)).width>this.size.x&&(i=t.measureText(this.text.substr(0,this.pointer)).width-this.size.x),this.active&&(t.strokeStyle=this.activeBorderColor,t.strokeRect(this.position.x+1,this.position.y+1,this.size.x-2,this.size.y-2),t.fillStyle=this.colorPointer,t.fillRect(this.position.x+t.measureText(this.text.substr(0,this.pointer)).width-i,this.position.y+this.size.y/6,2,this.size.y-this.size.y/3)),this.text.length>0?t.fillStyle=this.hover?this.colorHover:this.color:t.fillStyle=this.placeholderColor,t.strokeStyle=this.hover?this.colorHover:this.color,this.fill?t.fillText(this.text.length===0?this.placeholder:this.text,this.position.x-i,this.position.y+this.textMetrics.y/2+this.size.y/2):t.strokeText(this.text.length===0?this.placeholder:this.text,this.position.x-i,this.position.y+this.textMetrics.y/2+this.size.y/2),t.restore()}};var g=class extends f{constructor(t,i,s,e,h,o){super(t,i,s,e,h),this.container=!1,this.text=o,this.font="16px sans-serif",this.backgroundColor="#0005",this.color="#000",this.fill=!0,this.border=!1,this.align="left",this.textMetrics=new r(0,0)}draw=t=>{t.save(),t.beginPath(),t.rect(this.position.x,this.position.y,this.size.x,this.size.y),t.clip(),t.font=this.font,this.textMetrics.x=Math.ceil(t.measureText(this.text).width),this.textMetrics.y=Math.ceil(t.measureText(this.text).hangingBaseline),t.fillStyle=this.backgroundColor,t.fillRect(this.position.x,this.position.y,this.size.x,this.size.y),t.fillStyle=this.color,t.strokeStyle=this.color;let i=this.align==="center"?this.size.x/2-this.textMetrics.x/2:this.align==="right"?this.size.x-this.textMetrics.x:0;this.fill?t.fillText(this.text,this.position.x+i,this.position.y+this.textMetrics.y/2+this.size.y/2,this.size.x):t.strokeText(this.text,this.position.x+i,this.position.y+this.textMetrics.y/2+this.size.y/2,this.size.x),t.restore()}};export{d as Background,m as BoxCollider,y as Camara,p as Clock,x as Game,c as Input,w as KeyFrame,l as ObjectNode,E as Room,M as Sprite,R as Tilemap,f as UI,_ as UIButton,A as UIInput,g as UILabel,r as Vector2};
